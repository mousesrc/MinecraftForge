--- ../src-base/minecraft/net/minecraft/item/crafting/ShapelessRecipes.java
+++ ../src-work/minecraft/net/minecraft/item/crafting/ShapelessRecipes.java
@@ -6,57 +6,68 @@
 import net.minecraft.item.ItemStack;
 import net.minecraft.util.NonNullList;
 import net.minecraft.world.World;
+import org.bukkit.craftbukkit.inventory.CraftItemStack;
+import org.bukkit.craftbukkit.inventory.CraftShapelessRecipe;
 
 public class ShapelessRecipes implements IRecipe
 {
-    private final ItemStack field_77580_a;
-    public final List<ItemStack> field_77579_b;
+    private final ItemStack recipeOutput;
+    public final List<ItemStack> recipeItems;
 
-    public ShapelessRecipes(ItemStack p_i1918_1_, List<ItemStack> p_i1918_2_)
+    public ShapelessRecipes(ItemStack output, List<ItemStack> inputList)
     {
-        this.field_77580_a = p_i1918_1_;
-        this.field_77579_b = p_i1918_2_;
+        this.recipeOutput = output;
+        this.recipeItems = inputList;
     }
-
-    public ItemStack func_77571_b()
+    // CraftBukkit start
+    @SuppressWarnings("unchecked")
+    @Override
+    public org.bukkit.inventory.ShapelessRecipe toBukkitRecipe() {
+        CraftItemStack result = CraftItemStack.asCraftMirror(this.recipeOutput);
+        CraftShapelessRecipe recipe = new CraftShapelessRecipe(result, this);
+        for (ItemStack stack : (List<ItemStack>) this.recipeItems) {
+            if (stack != null) {
+                recipe.addIngredient(org.bukkit.craftbukkit.util.CraftMagicNumbers.getMaterial(stack.getItem()), stack.getMetadata());
+            }
+        }
+        return recipe;
+    }
+    // CraftBukkit end
+    public ItemStack getRecipeOutput()
     {
-        return this.field_77580_a;
+        return this.recipeOutput;
     }
 
-    public NonNullList<ItemStack> func_179532_b(InventoryCrafting p_179532_1_)
+    public NonNullList<ItemStack> getRemainingItems(InventoryCrafting inv)
     {
-        NonNullList<ItemStack> nonnulllist = NonNullList.<ItemStack>func_191197_a(p_179532_1_.func_70302_i_(), ItemStack.field_190927_a);
+        NonNullList<ItemStack> nonnulllist = NonNullList.<ItemStack>withSize(inv.getSizeInventory(), ItemStack.EMPTY);
 
         for (int i = 0; i < nonnulllist.size(); ++i)
         {
-            ItemStack itemstack = p_179532_1_.func_70301_a(i);
-
-            if (itemstack.func_77973_b().func_77634_r())
-            {
-                nonnulllist.set(i, new ItemStack(itemstack.func_77973_b().func_77668_q()));
-            }
+            ItemStack itemstack = inv.getStackInSlot(i);
+            nonnulllist.set(i, net.minecraftforge.common.ForgeHooks.getContainerItem(itemstack));
         }
 
         return nonnulllist;
     }
 
-    public boolean func_77569_a(InventoryCrafting p_77569_1_, World p_77569_2_)
+    public boolean matches(InventoryCrafting inv, World worldIn)
     {
-        List<ItemStack> list = Lists.newArrayList(this.field_77579_b);
+        List<ItemStack> list = Lists.newArrayList(this.recipeItems);
 
-        for (int i = 0; i < p_77569_1_.func_174923_h(); ++i)
+        for (int i = 0; i < inv.getHeight(); ++i)
         {
-            for (int j = 0; j < p_77569_1_.func_174922_i(); ++j)
+            for (int j = 0; j < inv.getWidth(); ++j)
             {
-                ItemStack itemstack = p_77569_1_.func_70463_b(j, i);
+                ItemStack itemstack = inv.getStackInRowAndColumn(j, i);
 
-                if (!itemstack.func_190926_b())
+                if (!itemstack.isEmpty())
                 {
                     boolean flag = false;
 
                     for (ItemStack itemstack1 : list)
                     {
-                        if (itemstack.func_77973_b() == itemstack1.func_77973_b() && (itemstack1.func_77960_j() == 32767 || itemstack.func_77960_j() == itemstack1.func_77960_j()))
+                        if (itemstack.getItem() == itemstack1.getItem() && (itemstack1.getMetadata() == 32767 || itemstack.getMetadata() == itemstack1.getMetadata()))
                         {
                             flag = true;
                             list.remove(itemstack1);
@@ -75,13 +86,13 @@
         return list.isEmpty();
     }
 
-    public ItemStack func_77572_b(InventoryCrafting p_77572_1_)
+    public ItemStack getCraftingResult(InventoryCrafting inv)
     {
-        return this.field_77580_a.func_77946_l();
+        return this.recipeOutput.copy();
     }
 
-    public int func_77570_a()
+    public int getRecipeSize()
     {
-        return this.field_77579_b.size();
+        return this.recipeItems.size();
     }
 }
