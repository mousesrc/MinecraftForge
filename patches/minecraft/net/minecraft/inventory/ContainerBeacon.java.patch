--- ../src-base/minecraft/net/minecraft/inventory/ContainerBeacon.java
+++ ../src-work/minecraft/net/minecraft/inventory/ContainerBeacon.java
@@ -1,22 +1,41 @@
 package net.minecraft.inventory;
 
 import net.minecraft.entity.player.EntityPlayer;
+import net.minecraft.entity.player.InventoryPlayer;
 import net.minecraft.init.Items;
 import net.minecraft.item.Item;
 import net.minecraft.item.ItemStack;
+import net.minecraft.tileentity.TileEntityBeacon;
 import net.minecraftforge.fml.relauncher.Side;
 import net.minecraftforge.fml.relauncher.SideOnly;
+import org.bukkit.craftbukkit.inventory.CraftInventoryView;
 
 public class ContainerBeacon extends Container
 {
-    private final IInventory field_82866_e;
-    private final ContainerBeacon.BeaconSlot field_82864_f;
+    private final IInventory tileBeacon;
+    private final ContainerBeacon.BeaconSlot beaconSlot;
+    // CraftBukkit start
+    private CraftInventoryView bukkitEntity = null;
+    private InventoryPlayer player;
+    // CraftBukkit end
+    // CraftBukkit start
+    @Override
+    public CraftInventoryView getBukkitView() {
+        if (bukkitEntity != null) {
+            return bukkitEntity;
+        }
 
-    public ContainerBeacon(IInventory p_i45804_1_, IInventory p_i45804_2_)
+        org.bukkit.craftbukkit.inventory.CraftInventory inventory = new org.bukkit.craftbukkit.inventory.CraftInventoryBeacon((TileEntityBeacon) this.tileBeacon); // TODO - check this
+        bukkitEntity = new CraftInventoryView(this.player.player.getBukkitEntity(), inventory, this);
+        return bukkitEntity;
+    }
+    // CraftBukkit end
+
+    public ContainerBeacon(IInventory playerInventory, IInventory tileBeaconIn)
     {
-        this.field_82866_e = p_i45804_2_;
-        this.field_82864_f = new ContainerBeacon.BeaconSlot(p_i45804_2_, 0, 136, 110);
-        this.func_75146_a(this.field_82864_f);
+        this.tileBeacon = tileBeaconIn;
+        this.beaconSlot = new ContainerBeacon.BeaconSlot(tileBeaconIn, 0, 136, 110);
+        this.addSlotToContainer(this.beaconSlot);
         int i = 36;
         int j = 137;
 
@@ -24,113 +43,110 @@
         {
             for (int l = 0; l < 9; ++l)
             {
-                this.func_75146_a(new Slot(p_i45804_1_, l + k * 9 + 9, 36 + l * 18, 137 + k * 18));
+                this.addSlotToContainer(new Slot(playerInventory, l + k * 9 + 9, 36 + l * 18, 137 + k * 18));
             }
         }
 
         for (int i1 = 0; i1 < 9; ++i1)
         {
-            this.func_75146_a(new Slot(p_i45804_1_, i1, 36 + i1 * 18, 195));
+            this.addSlotToContainer(new Slot(playerInventory, i1, 36 + i1 * 18, 195));
         }
     }
 
-    public void func_75132_a(IContainerListener p_75132_1_)
+    public void addListener(IContainerListener listener)
     {
-        super.func_75132_a(p_75132_1_);
-        p_75132_1_.func_175173_a(this, this.field_82866_e);
+        super.addListener(listener);
+        listener.sendAllWindowProperties(this, this.tileBeacon);
     }
 
     @SideOnly(Side.CLIENT)
-    public void func_75137_b(int p_75137_1_, int p_75137_2_)
+    public void updateProgressBar(int id, int data)
     {
-        this.field_82866_e.func_174885_b(p_75137_1_, p_75137_2_);
+        this.tileBeacon.setField(id, data);
     }
 
-    public IInventory func_180611_e()
+    public IInventory getTileEntity()
     {
-        return this.field_82866_e;
+        return this.tileBeacon;
     }
 
-    public void func_75134_a(EntityPlayer p_75134_1_)
+    public void onContainerClosed(EntityPlayer playerIn)
     {
-        super.func_75134_a(p_75134_1_);
+        super.onContainerClosed(playerIn);
 
-        if (p_75134_1_ != null && !p_75134_1_.field_70170_p.field_72995_K)
+        if (playerIn != null && !playerIn.world.isRemote)
         {
-            ItemStack itemstack = this.field_82864_f.func_75209_a(this.field_82864_f.func_75219_a());
+            ItemStack itemstack = this.beaconSlot.decrStackSize(this.beaconSlot.getSlotStackLimit());
 
-            if (!itemstack.func_190926_b())
+            if (!itemstack.isEmpty())
             {
-                p_75134_1_.func_71019_a(itemstack, false);
+                playerIn.dropItem(itemstack, false);
             }
         }
     }
 
-    public boolean func_75145_c(EntityPlayer p_75145_1_)
+    public boolean canInteractWith(EntityPlayer playerIn)
     {
-        return this.field_82866_e.func_70300_a(p_75145_1_);
+        return this.tileBeacon.isUsableByPlayer(playerIn);
     }
 
-    public ItemStack func_82846_b(EntityPlayer p_82846_1_, int p_82846_2_)
+    public ItemStack transferStackInSlot(EntityPlayer playerIn, int index)
     {
-        ItemStack itemstack = ItemStack.field_190927_a;
-        Slot slot = (Slot)this.field_75151_b.get(p_82846_2_);
+        ItemStack itemstack = ItemStack.EMPTY;
+        Slot slot = (Slot)this.inventorySlots.get(index);
 
-        if (slot != null && slot.func_75216_d())
+        if (slot != null && slot.getHasStack())
         {
-            ItemStack itemstack1 = slot.func_75211_c();
-            itemstack = itemstack1.func_77946_l();
+            ItemStack itemstack1 = slot.getStack();
+            itemstack = itemstack1.copy();
 
-            if (p_82846_2_ == 0)
+            if (index == 0)
             {
-                if (!this.func_75135_a(itemstack1, 1, 37, true))
+                if (!this.mergeItemStack(itemstack1, 1, 37, true))
                 {
-                    return ItemStack.field_190927_a;
+                    return ItemStack.EMPTY;
                 }
 
-                slot.func_75220_a(itemstack1, itemstack);
+                slot.onSlotChange(itemstack1, itemstack);
             }
-            else if (!this.field_82864_f.func_75216_d() && this.field_82864_f.func_75214_a(itemstack1) && itemstack1.func_190916_E() == 1)
+            else if (this.mergeItemStack(itemstack1, 0, 1, false)) //Forge Fix Shift Clicking in beacons with stacks larger then 1.
             {
-                if (!this.func_75135_a(itemstack1, 0, 1, false))
-                {
-                    return ItemStack.field_190927_a;
-                }
+                return ItemStack.EMPTY;
             }
-            else if (p_82846_2_ >= 1 && p_82846_2_ < 28)
+            else if (index >= 1 && index < 28)
             {
-                if (!this.func_75135_a(itemstack1, 28, 37, false))
+                if (!this.mergeItemStack(itemstack1, 28, 37, false))
                 {
-                    return ItemStack.field_190927_a;
+                    return ItemStack.EMPTY;
                 }
             }
-            else if (p_82846_2_ >= 28 && p_82846_2_ < 37)
+            else if (index >= 28 && index < 37)
             {
-                if (!this.func_75135_a(itemstack1, 1, 28, false))
+                if (!this.mergeItemStack(itemstack1, 1, 28, false))
                 {
-                    return ItemStack.field_190927_a;
+                    return ItemStack.EMPTY;
                 }
             }
-            else if (!this.func_75135_a(itemstack1, 1, 37, false))
+            else if (!this.mergeItemStack(itemstack1, 1, 37, false))
             {
-                return ItemStack.field_190927_a;
+                return ItemStack.EMPTY;
             }
 
-            if (itemstack1.func_190926_b())
+            if (itemstack1.isEmpty())
             {
-                slot.func_75215_d(ItemStack.field_190927_a);
+                slot.putStack(ItemStack.EMPTY);
             }
             else
             {
-                slot.func_75218_e();
+                slot.onSlotChanged();
             }
 
-            if (itemstack1.func_190916_E() == itemstack.func_190916_E())
+            if (itemstack1.getCount() == itemstack.getCount())
             {
-                return ItemStack.field_190927_a;
+                return ItemStack.EMPTY;
             }
 
-            slot.func_190901_a(p_82846_1_, itemstack1);
+            slot.onTake(playerIn, itemstack1);
         }
 
         return itemstack;
@@ -138,18 +154,17 @@
 
     class BeaconSlot extends Slot
     {
-        public BeaconSlot(IInventory p_i1801_2_, int p_i1801_3_, int p_i1801_4_, int p_i1801_5_)
+        public BeaconSlot(IInventory inventoryIn, int index, int xIn, int yIn)
         {
-            super(p_i1801_2_, p_i1801_3_, p_i1801_4_, p_i1801_5_);
+            super(inventoryIn, index, xIn, yIn);
         }
 
-        public boolean func_75214_a(ItemStack p_75214_1_)
+        public boolean isItemValid(ItemStack stack)
         {
-            Item item = p_75214_1_.func_77973_b();
-            return item == Items.field_151166_bC || item == Items.field_151045_i || item == Items.field_151043_k || item == Items.field_151042_j;
+            return stack.getItem().isBeaconPayment(stack);
         }
 
-        public int func_75219_a()
+        public int getSlotStackLimit()
         {
             return 1;
         }
