--- ../src-base/minecraft/net/minecraft/potion/Potion.java
+++ ../src-work/minecraft/net/minecraft/potion/Potion.java
@@ -13,7 +13,9 @@
 import net.minecraft.entity.ai.attributes.IAttribute;
 import net.minecraft.entity.ai.attributes.IAttributeInstance;
 import net.minecraft.entity.player.EntityPlayer;
+import net.minecraft.entity.player.EntityPlayerMP;
 import net.minecraft.init.MobEffects;
+import net.minecraft.network.play.server.SPacketUpdateHealth;
 import net.minecraft.util.DamageSource;
 import net.minecraft.util.ResourceLocation;
 import net.minecraft.util.StringUtils;
@@ -21,10 +23,13 @@
 import net.minecraft.util.registry.RegistryNamespaced;
 import net.minecraftforge.fml.relauncher.Side;
 import net.minecraftforge.fml.relauncher.SideOnly;
+import org.bukkit.craftbukkit.event.CraftEventFactory;
+import org.bukkit.event.entity.EntityRegainHealthEvent;
+import org.bukkit.event.entity.FoodLevelChangeEvent;
 
-public class Potion
+public class Potion extends net.minecraftforge.fml.common.registry.IForgeRegistryEntry.Impl<Potion>
 {
-    public static final RegistryNamespaced<ResourceLocation, Potion> field_188414_b = new RegistryNamespaced();
+    public static final RegistryNamespaced<ResourceLocation, Potion> field_188414_b = net.minecraftforge.fml.common.registry.GameData.getPotionRegistry();
     private final Map<IAttribute, AttributeModifier> field_111188_I = Maps.<IAttribute, AttributeModifier>newHashMap();
     private final boolean field_76418_K;
     private final int field_76414_N;
@@ -72,48 +77,41 @@
         return this;
     }
 
-    public void func_76394_a(EntityLivingBase p_76394_1_, int p_76394_2_)
-    {
-        if (this == MobEffects.field_76428_l)
-        {
-            if (p_76394_1_.func_110143_aJ() < p_76394_1_.func_110138_aP())
-            {
-                p_76394_1_.func_70691_i(1.0F);
+    public void func_76394_a(EntityLivingBase p_76394_1_, int p_76394_2_) {
+        if (this == MobEffects.field_76428_l) {
+            if (p_76394_1_.func_110143_aJ() < p_76394_1_.func_110138_aP()) {
+                p_76394_1_.heal(1.0F, EntityRegainHealthEvent.RegainReason.MAGIC_REGEN); // CraftBukkit
             }
-        }
-        else if (this == MobEffects.field_76436_u)
-        {
-            if (p_76394_1_.func_110143_aJ() > 1.0F)
-            {
-                p_76394_1_.func_70097_a(DamageSource.field_76376_m, 1.0F);
+        } else if (this == MobEffects.field_76436_u) {
+            if (p_76394_1_.func_110143_aJ() > 1.0F) {
+                p_76394_1_.func_70097_a(CraftEventFactory.POISON, 1.0F);
             }
-        }
-        else if (this == MobEffects.field_82731_v)
-        {
+        } else if (this == MobEffects.field_82731_v) {
             p_76394_1_.func_70097_a(DamageSource.field_82727_n, 1.0F);
-        }
-        else if (this == MobEffects.field_76438_s && p_76394_1_ instanceof EntityPlayer)
-        {
-            ((EntityPlayer)p_76394_1_).func_71020_j(0.005F * (float)(p_76394_2_ + 1));
-        }
-        else if (this == MobEffects.field_76443_y && p_76394_1_ instanceof EntityPlayer)
-        {
-            if (!p_76394_1_.field_70170_p.field_72995_K)
-            {
-                ((EntityPlayer)p_76394_1_).func_71024_bL().func_75122_a(p_76394_2_ + 1, 1.0F);
+        } else if (this == MobEffects.field_76438_s && p_76394_1_ instanceof EntityPlayer) {
+            ((EntityPlayer) p_76394_1_).func_71020_j(0.005F * (float) (p_76394_2_ + 1));
+        } else if (this == MobEffects.field_76443_y && p_76394_1_ instanceof EntityPlayer) {
+            if (!p_76394_1_.field_70170_p.field_72995_K) {
+                // CraftBukkit start
+                EntityPlayer entityhuman = (EntityPlayer) p_76394_1_;
+                int oldFoodLevel = entityhuman.func_71024_bL().field_75127_a;
+
+                FoodLevelChangeEvent event = CraftEventFactory.callFoodLevelChangeEvent(entityhuman, p_76394_2_ + 1 + oldFoodLevel);
+
+                if (!event.isCancelled()) {
+                    entityhuman.func_71024_bL().func_75122_a(event.getFoodLevel() - oldFoodLevel, 1.0F);
+                }
+
+                ((EntityPlayerMP) entityhuman).field_71135_a.func_147359_a(new SPacketUpdateHealth((float) ((EntityPlayerMP) entityhuman).getBukkitEntity().getHealth(), entityhuman.func_71024_bL().field_75127_a, entityhuman.func_71024_bL().field_75125_b));
+                // CraftBukkit end            }
+            } else if ((this != MobEffects.field_76432_h || p_76394_1_.func_70662_br()) && (this != MobEffects.field_76433_i || !p_76394_1_.func_70662_br())) {
+                if (this == MobEffects.field_76433_i && !p_76394_1_.func_70662_br() || this == MobEffects.field_76432_h && p_76394_1_.func_70662_br()) {
+                    p_76394_1_.func_70097_a(DamageSource.field_76376_m, (float) (6 << p_76394_2_));
+                }
+            } else {
+                p_76394_1_.func_70691_i((float) Math.max(4 << p_76394_2_, 0));
             }
         }
-        else if ((this != MobEffects.field_76432_h || p_76394_1_.func_70662_br()) && (this != MobEffects.field_76433_i || !p_76394_1_.func_70662_br()))
-        {
-            if (this == MobEffects.field_76433_i && !p_76394_1_.func_70662_br() || this == MobEffects.field_76432_h && p_76394_1_.func_70662_br())
-            {
-                p_76394_1_.func_70097_a(DamageSource.field_76376_m, (float)(6 << p_76394_2_));
-            }
-        }
-        else
-        {
-            p_76394_1_.func_70691_i((float)Math.max(4 << p_76394_2_, 0));
-        }
     }
 
     public void func_180793_a(@Nullable Entity p_180793_1_, @Nullable Entity p_180793_2_, EntityLivingBase p_180793_3_, int p_180793_4_, double p_180793_5_)
@@ -198,7 +196,6 @@
         return this.field_76417_J;
     }
 
-    @SideOnly(Side.CLIENT)
     public boolean func_76398_f()
     {
         return this.field_76418_K;
@@ -269,7 +266,74 @@
         return p_111183_2_.func_111164_d() * (double)(p_111183_1_ + 1);
     }
 
+    /* ======================================== FORGE START =====================================*/
+
+    /**
+     * If the Potion effect should be displayed in the players inventory
+     * @param effect the active PotionEffect
+     * @return true to display it (default), false to hide it.
+     */
+    public boolean shouldRender(PotionEffect effect) { return true; }
+
+    /**
+     * If the standard PotionEffect text (name and duration) should be drawn when this potion is active.
+     * @param effect the active PotionEffect
+     * @return true to draw the standard text
+     */
+    public boolean shouldRenderInvText(PotionEffect effect)
+    {
+        return true;
+    }
+
+    /**
+     * If the Potion effect should be displayed in the player's ingame HUD
+     * @param effect the active PotionEffect
+     * @return true to display it (default), false to hide it.
+     */
+    public boolean shouldRenderHUD(PotionEffect effect)
+    {
+        return true;
+    }
+
+    /**
+     * Called to draw the this Potion onto the player's inventory when it's active.
+     * This can be used to e.g. render Potion icons from your own texture.
+     * @param x the x coordinate
+     * @param y the y coordinate
+     * @param effect the active PotionEffect
+     * @param mc the Minecraft instance, for convenience
+     */
     @SideOnly(Side.CLIENT)
+    public void renderInventoryEffect(int x, int y, PotionEffect effect, net.minecraft.client.Minecraft mc) { }
+
+    /**
+     * Called to draw the this Potion onto the player's ingame HUD when it's active.
+     * This can be used to e.g. render Potion icons from your own texture.
+     * @param x the x coordinate
+     * @param y the y coordinate
+     * @param effect the active PotionEffect
+     * @param mc the Minecraft instance, for convenience
+     * @param alpha the alpha value, blinks when the potion is about to run out
+     */
+    @SideOnly(Side.CLIENT)
+    public void renderHUDEffect(int x, int y, PotionEffect effect, net.minecraft.client.Minecraft mc, float alpha) { }
+
+    /**
+     * Get a fresh list of items that can cure this Potion.
+     * All new PotionEffects created from this Potion will call this to initialize the default curative items
+     * @see PotionEffect#getCurativeItems
+     * @return A list of items that can cure this Potion
+     */
+    public java.util.List<net.minecraft.item.ItemStack> getCurativeItems()
+    {
+        java.util.ArrayList<net.minecraft.item.ItemStack> ret = new java.util.ArrayList<net.minecraft.item.ItemStack>();
+        ret.add(new net.minecraft.item.ItemStack(net.minecraft.init.Items.field_151117_aB));
+        return ret;
+    }
+
+    /* ======================================== FORGE END =====================================*/
+
+    @SideOnly(Side.CLIENT)
     public boolean func_188408_i()
     {
         return this.field_188415_h;
@@ -310,5 +374,10 @@
         field_188414_b.func_177775_a(25, new ResourceLocation("levitation"), (new Potion(true, 13565951)).func_76390_b("effect.levitation").func_76399_b(3, 2));
         field_188414_b.func_177775_a(26, new ResourceLocation("luck"), (new Potion(false, 3381504)).func_76390_b("effect.luck").func_76399_b(5, 2).func_188413_j().func_111184_a(SharedMonsterAttributes.field_188792_h, "03C3C89D-7037-4B42-869F-B146BCB64D2E", 1.0D, 0));
         field_188414_b.func_177775_a(27, new ResourceLocation("unluck"), (new Potion(true, 12624973)).func_76390_b("effect.unluck").func_76399_b(6, 2).func_111184_a(SharedMonsterAttributes.field_188792_h, "CC5AF142-2BD2-4215-B636-2605AED11727", -1.0D, 0));
+        //CraftBukkit start
+        for (Object effect : field_188414_b) {
+            org.bukkit.potion.PotionEffectType.registerPotionEffectType(new org.bukkit.craftbukkit.potion.CraftPotionEffectType((net.minecraft.potion.Potion) effect));
+        }
+        // CraftBukkit end
     }
 }
